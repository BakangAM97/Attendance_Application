<div class="container">
  <div class="row show-row">
    <div class="col-5 show-containers">
      <%= image_tag("profile_placeholder" , size: "200x200", class: "show-profile") %>
    </div>
    <div class="col-5 show-containers">
      <h1><%= @student.name.capitalize %>
      -<%if @student.active == true %>
      <span class="active">Active</span>
      <%else%>
      <span class="inactive">Inactive</span>
      <%end%>
      </h1>
      <h1>Group: <%= @group.name.upcase %></h1>
      <h1>Stream: <%=@group.stream.upcase %></h1>
    </div>
  </div>

  <table class="table">
    <thead>
      <tr>
        <th scope="col">On Time</th>
        <th scope="col">< 5 mins</th>
        <th scope="col">> 5 mins</th>
        <th scope="col">Authorised</th>
        <th scope="col">Unauthorised</th>
      </tr>
    </thead>
    <tbody>

      <% att_array = [0, 0, 0, 0, 0]
         percArray = [0, 0, 0, 0, 0] %>

      <tr>

        <% @student.attendances.each do |attendance| %>

          <%

          case attendance.att_status
          when 1
            att_array[0] += 1
          when 2
            att_array[1] += 1
          when 3
            att_array[2] += 1
          when 4
            att_array[3] += 1
          when 5
            att_array[4] += 1
          end

          %>

        <% end %>

        <%

        sum = 0.0

        att_array.each do |value|
          sum+=value
        end

        percArray[0] = ((att_array[0] / sum) * 100).round 2
        percArray[1] = ((att_array[1] / sum) * 100).round 2
        percArray[2] = ((att_array[2] / sum) * 100).round 2
        percArray[3] = ((att_array[3] / sum) * 100).round 2
        percArray[4] = ((att_array[4] / sum) * 100).round 2

        %>

        <td><%= percArray[0] %>%</td>
        <td><%= percArray[1] %>%</td>
        <td><%= percArray[2] %>%</td>
        <td><%= percArray[3] %>%</td>
        <td><%= percArray[4] %>%</td>

      </tr>
    </tbody>
  </table>

<!-- CALENDAR ----------------->

  <h1>Calendar</h1>

  <table class="table table-bordered">
  <thead>
    <tr>
      <th scope="col">Week</th>
      <th scope="col">Monday</th>
      <th scope="col">Tuesday</th>
      <th scope="col">Wednesday</th>
      <th scope="col">Thursday</th>
      <th scope="col">Friday</th>
      <th scope="col">Saturday</th>
      <th scope="col">Sunday</th>
    </tr>
  </thead>
  <tbody>
    <% @group.startdate %>
    <% @group.enddate %>
    <% cDays = (@group.enddate - @group.startdate).to_f %>
    <h3>Total Weeks: <%= cWeeks = (cDays / 7).ceil %></h3>

    <% count = -7 %>
    <% (1..cWeeks).each do |i| %>
    <% count = count + 7 %>
      <tr>
        <th scope="row"><%= i %></th>
        <% if @student.attendances[count].nil? %>
        <td></td>
        <% else %>
        <td><%= @student.attendances[count].att_status %></td>
        <% end %>

        <% if @student.attendances[count + 1].nil? %>
        <td></td>
        <% else %>
        <td><%= @student.attendances[count + 1].att_status %></td>
        <% end %>

        <% if @student.attendances[count + 2].nil? %>
        <td></td>
        <% else %>
        <td><%= @student.attendances[count + 2].att_status %></td>
        <% end %>

        <% if @student.attendances[count + 3].nil? %>
        <td></td>
        <% else %>
        <td><%= @student.attendances[count + 3].att_status %></td>
        <% end %>

        <% if @student.attendances[count + 4].nil? %>
        <td></td>
        <% else %>
        <td><%= @student.attendances[count + 4].att_status %></td>
        <% end %>

        <% if @student.attendances[count + 5].nil? %>
        <td></td>
        <% else %>
        <td><%= @student.attendances[count + 5].att_status %></td>
        <% end %>

        <% if @student.attendances[count + 6].nil? %>
        <td></td>
        <% else %>
        <td><%= @student.attendances[count + 6].att_status %></td>
        <% end %>

      

      </tr>
    <% end %>
  </tbody>
</table>

<!-- Have a switch statement for the att_status attribute. Depending on the number, 1 to 5, this dictates what colour the <td></td> div will take. Each switch statement will change the class of that particular <td></td>?  -->
<!-- Each monday will display (in the bottom right hand corner) the date -->
<!-- The start date will correspond to the first "div" of the calendar. The next "div" will be that date + 1 -->
<!-- Every 5th day have to +2 to compensate for the weekend? -->

<!-- END OF CALENDAR ------------------>

  <div class="show-attendance">

  </div>
  <div class="actions-list">
    <%= link_to "Edit Student", edit_student_path, class: "btn btn-primary" %>
    <%= link_to "Delete Student", @student, method: :delete, class: "btn btn-danger" %>
  </div>
</div>
